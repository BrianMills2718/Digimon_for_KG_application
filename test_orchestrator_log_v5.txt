TOP LEVEL DIAG: Attempting to write /tmp/top_level_diag.txt
TOP LEVEL DIAG: Successfully wrote /tmp/top_level_diag.txt
DEBUG_STDERR_CAPTURE: sys.stderr is: <_io.TextIOWrapper name='<stderr>' mode='w' encoding='utf-8'>
DEBUG_STDERR_CAPTURE: captured_stderr_ref is: <_io.TextIOWrapper name='<stderr>' mode='w' encoding='utf-8'>
CONFIG DIAG: Attempting to access main_config and write /tmp/config_attrs_diag.txt
CONFIG DIAG: Successfully accessed main_config and wrote /tmp/config_attrs_diag.txt
2025-05-31 11:55:54.812 | INFO     | __main__:main_orchestrator_test:170 - --- Starting Agent Orchestrator Test ---
2025-05-31 11:55:54.812 | INFO     | __main__:setup_graphrag_context_for_orchestrator:84 - Orchestrator Test: Setting up GraphRAGContext...
2025-05-31 11:55:54.813 | INFO     | __main__:setup_graphrag_context_for_orchestrator:88 - Orchestrator Test: Embedding provider type: <class 'llama_index.embeddings.openai.base.OpenAIEmbedding'>
2025-05-31 11:55:54.813 | INFO     | Core.Graph.GraphFactory:get_graph:43 - GraphFactory: Creating graph of type 'er_graph' with kwargs: {'data_path': './results/MySampleTexts/kg_graph', 'storage_type': 'networkx', 'storage_instance': NetworkXStorage(config=None, namespace=<Core.Storage.NameSpace.NameSpace object at 0x7f3d6196b8b0>, name='graph_storage_nx_data.graphml')}
2025-05-31 11:55:54.813 | DEBUG    | Core.Graph.GraphFactory:_create_er_graph:50 - GraphFactory._create_er_graph: full_config type: <class 'Option.Config2.Config'>, constructor_kwargs: {'data_path': './results/MySampleTexts/kg_graph', 'storage_type': 'networkx', 'storage_instance': NetworkXStorage(config=None, namespace=<Core.Storage.NameSpace.NameSpace object at 0x7f3d6196b8b0>, name='graph_storage_nx_data.graphml')}
2025-05-31 11:55:54.813 | INFO     | Core.Graph.BaseGraph:load_persisted_graph:32 - Attempting to load persisted graph via NetworkXStorage.load_graph(force=False)
2025-05-31 11:55:54.813 | INFO     | Core.Storage.NetworkXStorage:load_nx_graph:33 - Attempting to load the graph from: ./results/MySampleTexts/kg_graph/graph_storage_nx_data.graphml
2025-05-31 11:55:54.817 | INFO     | Core.Storage.NetworkXStorage:load_nx_graph:37 - Successfully loaded graph from: ./results/MySampleTexts/kg_graph/graph_storage_nx_data.graphml with 108 nodes and 72 edges
2025-05-31 11:55:54.817 | INFO     | __main__:setup_graphrag_context_for_orchestrator:117 - Orchestrator Test: Graph instance loaded. Node count: 108. Type: <class 'Core.Graph.ERGraph.ERGraph'>
2025-05-31 11:55:54.817 | INFO     | __main__:setup_graphrag_context_for_orchestrator:119 - Orchestrator Test: Type of graph_instance from factory: <class 'Core.Graph.ERGraph.ERGraph'>
2025-05-31 11:55:54.817 | INFO     | Core.Index.BaseIndex:load:16 - Attempting to load existing index from: ./results/MySampleTexts/kg_graph/entities_vdb
2025-05-31 11:55:54.817 | INFO     | Core.Index.FaissIndex:_load_index:234 - FaissIndex._load_index: Attempting to load index from persist_path: ./results/MySampleTexts/kg_graph/entities_vdb
2025-05-31 11:55:54.817 | INFO     | Core.Index.FaissIndex:_load_index:237 - FaissIndex._load_index: Set Settings.embed_model to: <class 'llama_index.embeddings.openai.base.OpenAIEmbedding'>
2025-05-31 11:55:54.817 | INFO     | Core.Index.FaissIndex:_load_index:242 - FaissIndex._load_index: Persist path ./results/MySampleTexts/kg_graph/entities_vdb confirmed to exist.
2025-05-31 11:55:54.817 | INFO     | Core.Index.FaissIndex:_load_index:243 - FaissIndex._load_index: Contents of persist_path: ['index_store.json', 'docstore.json', 'default__vector_store.json', 'image__vector_store.json', 'graph_store.json']
2025-05-31 11:55:54.818 | INFO     | Core.Index.FaissIndex:_load_index:247 - FaissIndex._load_index: Successfully called FaissVectorStore.from_persist_dir().
2025-05-31 11:55:54.818 | INFO     | Core.Index.FaissIndex:_load_index:248 - FaissIndex._load_index: Type of loaded vector_store: <class 'llama_index.vector_stores.faiss.base.FaissVectorStore'>
2025-05-31 11:55:54.818 | INFO     | Core.Index.FaissIndex:_load_index:251 - FaissIndex._load_index: Loaded vector_store has attribute _faiss_index.
2025-05-31 11:55:54.818 | INFO     | Core.Index.FaissIndex:_load_index:252 - FaissIndex._load_index: vector_store._faiss_index object: <faiss.swigfaiss_avx2.IndexHNSWFlat; proxy of <Swig Object of type 'faiss::IndexHNSWFlat *' at 0x7f3d6196ba50> >
2025-05-31 11:55:54.818 | INFO     | Core.Index.FaissIndex:_load_index:253 - FaissIndex._load_index: Loaded vector_store._faiss_index.ntotal: 108
2025-05-31 11:55:54.819 | INFO     | Core.Index.FaissIndex:_load_index:264 - FaissIndex._load_index: StorageContext created from defaults with loaded vector_store.
2025-05-31 11:55:54.924 | INFO     | Core.Index.FaissIndex:_load_index:271 - FaissIndex._load_index: Successfully loaded index from storage. Index object: <llama_index.core.indices.vector_store.base.VectorStoreIndex object at 0x7f3d6196a3b0>
2025-05-31 11:55:54.924 | INFO     | Core.Index.FaissIndex:_load_index:274 - FaissIndex._load_index: Index ID: 76756585-8f1b-482c-bd54-bbe56f6eebf9, Summary: None
2025-05-31 11:55:54.924 | INFO     | Core.Index.BaseIndex:load:20 - Successfully loaded existing index from: ./results/MySampleTexts/kg_graph/entities_vdb
2025-05-31 11:55:54.924 | INFO     | __main__:setup_graphrag_context_for_orchestrator:139 - Orchestrator Test: Entities VDB loaded successfully for context setup.
2025-05-31 11:55:54.924 | INFO     | __main__:setup_graphrag_context_for_orchestrator:166 - Orchestrator Test: GraphRAGContext created.
2025-05-31 11:55:54.924 | INFO     | __main__:main_orchestrator_test:247 - Orchestrator Test: ExecutionPlan defined:
{
  "plan_id": "test_plan_002_vdb_then_ppr",
  "plan_description": "2-step plan: VDB search for 'american revolution', then PPR on results.",
  "target_dataset_name": "MySampleTexts",
  "ontology_setup": null,
  "global_llm_config_patch": null,
  "global_embedding_config_patch": null,
  "plan_inputs": {
    "main_query": "causes of the american revolution"
  },
  "steps": [
    {
      "step_id": "step1_vdb_search",
      "description": "Perform a VDB search for entities related to the user query.",
      "action": {
        "chain_description": null,
        "tools": [
          {
            "tool_id": "Entity.VDBSearch",
            "description": "Find initial relevant entities using VDB.",
            "parameters": {
              "vdb_reference_id": "entities_vdb",
              "top_k_results": 3
            },
            "inputs": {
              "query_text": "plan_inputs.main_query"
            },
            "named_outputs": {
              "vdb_search_results_object": "Raw EntityVDBSearchOutputs object from VDB search."
            }
          }
        ]
      }
    },
    {
      "step_id": "step2_entity_ppr",
      "description": "Run Personalized PageRank on entities found by VDB search.",
      "action": {
        "chain_description": null,
        "tools": [
          {
            "tool_id": "Entity.PPR",
            "description": "Calculate PPR scores for seed entities.",
            "parameters": {
              "graph_reference_id": "kg_graph",
              "personalization_weight_alpha": 0.25,
              "max_iterations": 50,
              "top_k_results": 5
            },
            "inputs": {
              "seed_entity_ids": {
                "from_step_id": "step1_vdb_search",
                "named_output_key": "vdb_search_results_object"
              }
            },
            "named_outputs": {
              "ppr_ranked_entities": "List of (entity_id, ppr_score) tuples from PPR."
            }
          }
        ]
      }
    }
  ]
}
2025-05-31 11:55:54.924 | INFO     | Core.AgentOrchestrator.orchestrator:_register_tools:34 - AgentOrchestrator: Registered 3 tools with Pydantic models: ['Entity.VDBSearch', 'Entity.PPR', 'Relationship.OneHopNeighbors']
2025-05-31 11:55:54.924 | INFO     | __main__:main_orchestrator_test:252 - Orchestrator Test: Executing plan...
2025-05-31 11:55:54.924 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:38 - Orchestrator: Starting execution of plan ID: test_plan_002_vdb_then_ppr - 2-step plan: VDB search for 'american revolution', then PPR on results.
2025-05-31 11:55:54.924 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:42 - Orchestrator: Executing Step 1/2: step1_vdb_search - Perform a VDB search for entities related to the user query.
2025-05-31 11:55:54.925 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:47 - Orchestrator: Step step1_vdb_search is a DynamicToolChainConfig with 1 tool(s).
2025-05-31 11:55:54.925 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:64 - Orchestrator: Executing tool 1/1 in step step1_vdb_search: Entity.VDBSearch
2025-05-31 11:55:54.925 | DEBUG    | Core.AgentOrchestrator.orchestrator:_resolve_tool_inputs:149 - Orchestrator: Resolved input 'query_text' from plan_inputs, key 'main_query'
2025-05-31 11:55:54.925 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:87 - Orchestrator: Attempting to instantiate EntityVDBSearchInputs with params: {'vdb_reference_id': 'entities_vdb', 'top_k_results': 3, 'query_text': 'causes of the american revolution'}
2025-05-31 11:55:54.925 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:89 - Orchestrator: Successfully instantiated EntityVDBSearchInputs for tool Entity.VDBSearch
2025-05-31 11:55:54.925 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:92 - Orchestrator: Calling tool function: entity_vdb_search_tool for tool ID: Entity.VDBSearch
2025-05-31 11:55:54.925 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:77 - Executing tool 'Entity.VDBSearch' with parameters: vdb_reference_id='entities_vdb', query_text='causes of the american revolution', top_k_results=3
2025-05-31 11:55:54.925 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:106 - Entity.VDBSearch: Accessing LlamaIndex VectorStoreIndex via vdb_instance._index. Type: <class 'llama_index.core.indices.vector_store.base.VectorStoreIndex'>
2025-05-31 11:55:55.107 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:144 - Entity.VDBSearch: Found 3 similar entities.
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:94 - Orchestrator: Tool Entity.VDBSearch executed. Output type: <class 'Core.AgentSchema.tool_contracts.EntityVDBSearchOutputs'>
2025-05-31 11:55:55.108 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:95 - Orchestrator: Raw output from tool Entity.VDBSearch: similar_entities=[VDBSearchResultItem(node_id='f667f6639611608ec904ffdc8aee83a4', entity_name='american revolution', score=0.7815490365028381), VDBSearchResultItem(node_id='01d6bdf17b79451927aa8e2e1ec87bed', entity_name='leaders of the american revolution', score=0.7901535630226135), VDBSearchResultItem(node_id='5c7fd3c6be5bf98f2b891251ba8effba', entity_name='american revolutionary war', score=0.8133000135421753)]
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:111 - Orchestrator: Stored output 'vdb_search_results_object' for step step1_vdb_search (tool Entity.VDBSearch) as Pydantic model or its primary attribute.
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:42 - Orchestrator: Executing Step 2/2: step2_entity_ppr - Run Personalized PageRank on entities found by VDB search.
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:47 - Orchestrator: Step step2_entity_ppr is a DynamicToolChainConfig with 1 tool(s).
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:64 - Orchestrator: Executing tool 1/1 in step step2_entity_ppr: Entity.PPR
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:_resolve_tool_inputs:177 - Orchestrator: Transformed 'similar_entities' from step 'step1_vdb_search' into List[str] of entity names for input 'seed_entity_ids'. Extracted 3 IDs.
2025-05-31 11:55:55.108 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:87 - Orchestrator: Attempting to instantiate EntityPPRInputs with params: {'graph_reference_id': 'kg_graph', 'personalization_weight_alpha': 0.25, 'max_iterations': 50, 'top_k_results': 5, 'seed_entity_ids': ['american revolution', 'leaders of the american revolution', 'american revolutionary war']}
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:89 - Orchestrator: Successfully instantiated EntityPPRInputs for tool Entity.PPR
2025-05-31 11:55:55.108 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:92 - Orchestrator: Calling tool function: entity_ppr_tool for tool ID: Entity.PPR
2025-05-31 11:55:55.108 | INFO     | Core.AgentTools.entity_tools:entity_ppr_tool:275 - Executing tool 'Entity.PPR' with parameters: graph_reference_id='kg_graph' seed_entity_ids=['american revolution', 'leaders of the american revolution', 'american revolutionary war'] personalization_weight_alpha=0.25 max_iterations=50 top_k_results=5
2025-05-31 11:55:55.109 | INFO     | Core.AgentTools.entity_tools:entity_ppr_tool:308 - Entity.PPR: Using RetrieverConfig: {'top_k_entity_for_ppr': 5, 'top_k': 10}
2025-05-31 11:55:55.109 | INFO     | Core.AgentTools.entity_tools:entity_ppr_tool:341 - Entity.PPR: Calling _find_relevant_entities_by_ppr with 3 seeds. Linking: True. Args: ['american revolution', 'leaders of the american revolution', 'american revolutionary war']
2025-05-31 11:55:55.807 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:60 - BaseRetriever: Diagnosing entities_vdb before first call in _run_personalized_pagerank:
2025-05-31 11:55:55.807 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:64 - BaseRetriever: type(self.entities_vdb) is <class 'Core.Index.FaissIndex.FaissIndex'>
2025-05-31 11:55:55.807 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:65 - BaseRetriever: hasattr(self.entities_vdb, 'retrieval_nodes_with_score_matrix') is True
2025-05-31 11:55:55.807 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:67 - BaseRetriever: self.entities_vdb.retrieval_nodes_with_score_matrix is <bound method FaissIndex.retrieval_nodes_with_score_matrix of <Core.Index.FaissIndex.FaissIndex object at 0x7f3d6196a7a0>>
2025-05-31 11:55:55.807 | INFO     | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:26 - FaissIndex.retrieval_nodes_with_score_matrix called with query_list type: <class 'list'>, top_k: 1
2025-05-31 11:55:55.807 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:45 - FaissIndex.retrieval_nodes_with_score_matrix: Processing list of query items (count: 3)
2025-05-31 11:55:55.807 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:49 -   Item 0 is dict, using entity_name: american rebellion
2025-05-31 11:55:55.807 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:49 -   Item 1 is dict, using entity_name: leaders of the american revolution
2025-05-31 11:55:55.807 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:49 -   Item 2 is dict, using entity_name: american revolutionary war
2025-05-31 11:55:55.808 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:66 - FaissIndex.retrieval_nodes_with_score_matrix: Performing VDB lookup for target_query: 'american rebellion' with top_k=1
2025-05-31 11:55:55.910 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:77 -   Lookup for 'american rebellion' found 1 nodes.
2025-05-31 11:55:55.910 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'american rebellion' (idx 99): score 1.5735113265691325e-06, new aggregated score 1.5735113265691325e-06
2025-05-31 11:55:55.910 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:66 - FaissIndex.retrieval_nodes_with_score_matrix: Performing VDB lookup for target_query: 'leaders of the american revolution' with top_k=1
2025-05-31 11:55:56.039 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:77 -   Lookup for 'leaders of the american revolution' found 1 nodes.
2025-05-31 11:55:56.039 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'leaders of the american revolution' (idx 5): score 0.4328322410583496, new aggregated score 0.4328322410583496
2025-05-31 11:55:56.039 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:66 - FaissIndex.retrieval_nodes_with_score_matrix: Performing VDB lookup for target_query: 'american revolutionary war' with top_k=1
2025-05-31 11:55:56.153 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:77 -   Lookup for 'american revolutionary war' found 1 nodes.
2025-05-31 11:55:56.153 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'american revolutionary war' (idx 3): score 0.4950897991657257, new aggregated score 0.4950897991657257
2025-05-31 11:55:56.154 | INFO     | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:102 - FaissIndex.retrieval_nodes_with_score_matrix: Returning normalized score vector (sum before norm: 0.9279).
2025-05-31 11:55:56.154 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:77 - BaseRetriever: Diagnosing entities_vdb before second call in _run_personalized_pagerank:
2025-05-31 11:55:56.154 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:81 - BaseRetriever: type(self.entities_vdb) is <class 'Core.Index.FaissIndex.FaissIndex'>
2025-05-31 11:55:56.154 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:82 - BaseRetriever: hasattr(self.entities_vdb, 'retrieval_nodes_with_score_matrix') is True
2025-05-31 11:55:56.154 | DEBUG    | Core.Retriever.BaseRetriever:_run_personalized_pagerank:84 - BaseRetriever: self.entities_vdb.retrieval_nodes_with_score_matrix is <bound method FaissIndex.retrieval_nodes_with_score_matrix of <Core.Index.FaissIndex.FaissIndex object at 0x7f3d6196a7a0>>
2025-05-31 11:55:56.154 | INFO     | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:26 - FaissIndex.retrieval_nodes_with_score_matrix called with query_list type: <class 'str'>, top_k: 5
2025-05-31 11:55:56.154 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:43 - FaissIndex.retrieval_nodes_with_score_matrix: Processing single query string: american revolution
2025-05-31 11:55:56.154 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:66 - FaissIndex.retrieval_nodes_with_score_matrix: Performing VDB lookup for target_query: 'american revolution' with top_k=5
2025-05-31 11:55:56.272 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:77 -   Lookup for 'american revolution' found 5 nodes.
2025-05-31 11:55:56.272 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'american rebellion' (idx 99): score 0.49192023277282715, new aggregated score 0.49192023277282715
2025-05-31 11:55:56.272 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'american revolution' (idx 0): score 0.6098762154579163, new aggregated score 0.6098762154579163
2025-05-31 11:55:56.272 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'american revolutionary war' (idx 3): score 0.6720759868621826, new aggregated score 0.6720759868621826
2025-05-31 11:55:56.273 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'british america' (idx 2): score 0.8151015043258667, new aggregated score 0.8151015043258667
2025-05-31 11:55:56.273 | DEBUG    | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:85 -     Node 'thirteen colonies' (idx 1): score 0.8976986408233643, new aggregated score 0.8976986408233643
2025-05-31 11:55:56.273 | INFO     | Core.Index.FaissIndex:retrieval_nodes_with_score_matrix:102 - FaissIndex.retrieval_nodes_with_score_matrix: Returning normalized score vector (sum before norm: 3.4867).
2025-05-31 11:55:56.274 | INFO     | Core.AgentTools.entity_tools:entity_ppr_tool:361 - Entity.PPR: Processing 10 nodes returned by retriever's PPR.
2025-05-31 11:55:56.274 | INFO     | Core.AgentTools.entity_tools:entity_ppr_tool:387 - Entity.PPR tool returning 5 ranked entities.
2025-05-31 11:55:56.274 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:94 - Orchestrator: Tool Entity.PPR executed. Output type: <class 'Core.AgentSchema.tool_contracts.EntityPPROutputs'>
2025-05-31 11:55:56.274 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:95 - Orchestrator: Raw output from tool Entity.PPR: ranked_entities=[('american revolutionary war', 0.3365084390370822), ('leaders of the american revolution', 0.2162394882675159), ('american revolution', 0.12041700340848793), ('thirteen colonies', 0.11809737382543736), ('british america', 0.10644354556128208)]
2025-05-31 11:55:56.274 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:111 - Orchestrator: Stored output 'ppr_ranked_entities' for step step2_entity_ppr (tool Entity.PPR) as Pydantic model or its primary attribute.
2025-05-31 11:55:56.274 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:131 - Orchestrator: Plan execution finished. Final result from step 'step2_entity_ppr': {'ppr_ranked_entities': EntityPPROutputs(ranked_entities=[('american revolutionary war', 0.3365084390370822), ('leaders of the american revolution', 0.2162394882675159), ('american revolution', 0.12041700340848793), ('thirteen colonies', 0.11809737382543736), ('british america', 0.10644354556128208)])}
2025-05-31 11:55:56.275 | INFO     | __main__:main_orchestrator_test:255 - Orchestrator Test: Plan execution finished. Final output from orchestrator (last step's output): {'ppr_ranked_entities': EntityPPROutputs(ranked_entities=[('american revolutionary war', 0.3365084390370822), ('leaders of the american revolution', 0.2162394882675159), ('american revolution', 0.12041700340848793), ('thirteen colonies', 0.11809737382543736), ('british america', 0.10644354556128208)])}
2025-05-31 11:55:56.275 | INFO     | __main__:main_orchestrator_test:256 - Orchestrator Test: All step outputs: {'step1_vdb_search': {'vdb_search_results_object': EntityVDBSearchOutputs(similar_entities=[VDBSearchResultItem(node_id='f667f6639611608ec904ffdc8aee83a4', entity_name='american revolution', score=0.7815490365028381), VDBSearchResultItem(node_id='01d6bdf17b79451927aa8e2e1ec87bed', entity_name='leaders of the american revolution', score=0.7901535630226135), VDBSearchResultItem(node_id='5c7fd3c6be5bf98f2b891251ba8effba', entity_name='american revolutionary war', score=0.8133000135421753)])}, 'step2_entity_ppr': {'ppr_ranked_entities': EntityPPROutputs(ranked_entities=[('american revolutionary war', 0.3365084390370822), ('leaders of the american revolution', 0.2162394882675159), ('american revolution', 0.12041700340848793), ('thirteen colonies', 0.11809737382543736), ('british america', 0.10644354556128208)])}}
2025-05-31 11:55:56.275 | INFO     | __main__:main_orchestrator_test:259 - 
--- Starting Test Plan 3: Entity.VDBSearch -> Relationship.OneHopNeighbors ---
2025-05-31 11:55:56.275 | INFO     | __main__:run_vdb_to_one_hop_neighbors_plan:323 - Orchestrator Test: ExecutionPlan defined:
{
  "plan_id": "test_plan_003_vdb_then_one_hop",
  "plan_description": "2-step plan: VDB search, then find one-hop neighbors.",
  "target_dataset_name": "MySampleTexts",
  "ontology_setup": null,
  "global_llm_config_patch": null,
  "global_embedding_config_patch": null,
  "plan_inputs": {
    "main_query": "causes of the french revolution"
  },
  "steps": [
    {
      "step_id": "step1_vdb_for_one_hop",
      "description": "Perform a VDB search for entities.",
      "action": {
        "chain_description": null,
        "tools": [
          {
            "tool_id": "Entity.VDBSearch",
            "description": "Find initial relevant entities using VDB.",
            "parameters": {
              "vdb_reference_id": "entities_vdb",
              "top_k_results": 2
            },
            "inputs": {
              "query_text": "plan_inputs.main_query"
            },
            "named_outputs": {
              "vdb_search_output": "Output from VDB search containing entity IDs and scores."
            }
          }
        ]
      }
    },
    {
      "step_id": "step2_one_hop_neighbors",
      "description": "Find one-hop neighbors for entities found by VDB search.",
      "action": {
        "chain_description": null,
        "tools": [
          {
            "tool_id": "Relationship.OneHopNeighbors",
            "description": "Get one-hop neighbors and their relationship details.",
            "parameters": {},
            "inputs": {
              "entity_ids": {
                "from_step_id": "step1_vdb_for_one_hop",
                "named_output_key": "vdb_search_output"
              }
            },
            "named_outputs": {
              "one_hop_neighbor_details": "List of NeighborDetail objects."
            }
          }
        ]
      }
    }
  ]
}
2025-05-31 11:55:56.275 | INFO     | __main__:run_vdb_to_one_hop_neighbors_plan:324 - Orchestrator Test: Executing VDB -> OneHopNeighbors plan...
2025-05-31 11:55:56.275 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:38 - Orchestrator: Starting execution of plan ID: test_plan_003_vdb_then_one_hop - 2-step plan: VDB search, then find one-hop neighbors.
2025-05-31 11:55:56.275 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:42 - Orchestrator: Executing Step 1/2: step1_vdb_for_one_hop - Perform a VDB search for entities.
2025-05-31 11:55:56.275 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:47 - Orchestrator: Step step1_vdb_for_one_hop is a DynamicToolChainConfig with 1 tool(s).
2025-05-31 11:55:56.275 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:64 - Orchestrator: Executing tool 1/1 in step step1_vdb_for_one_hop: Entity.VDBSearch
2025-05-31 11:55:56.275 | DEBUG    | Core.AgentOrchestrator.orchestrator:_resolve_tool_inputs:149 - Orchestrator: Resolved input 'query_text' from plan_inputs, key 'main_query'
2025-05-31 11:55:56.275 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:87 - Orchestrator: Attempting to instantiate EntityVDBSearchInputs with params: {'vdb_reference_id': 'entities_vdb', 'top_k_results': 2, 'query_text': 'causes of the french revolution'}
2025-05-31 11:55:56.275 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:89 - Orchestrator: Successfully instantiated EntityVDBSearchInputs for tool Entity.VDBSearch
2025-05-31 11:55:56.276 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:92 - Orchestrator: Calling tool function: entity_vdb_search_tool for tool ID: Entity.VDBSearch
2025-05-31 11:55:56.276 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:77 - Executing tool 'Entity.VDBSearch' with parameters: vdb_reference_id='entities_vdb', query_text='causes of the french revolution', top_k_results=2
2025-05-31 11:55:56.276 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:106 - Entity.VDBSearch: Accessing LlamaIndex VectorStoreIndex via vdb_instance._index. Type: <class 'llama_index.core.indices.vector_store.base.VectorStoreIndex'>
2025-05-31 11:55:56.388 | INFO     | Core.AgentTools.entity_tools:entity_vdb_search_tool:144 - Entity.VDBSearch: Found 2 similar entities.
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:94 - Orchestrator: Tool Entity.VDBSearch executed. Output type: <class 'Core.AgentSchema.tool_contracts.EntityVDBSearchOutputs'>
2025-05-31 11:55:56.388 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:95 - Orchestrator: Raw output from tool Entity.VDBSearch: similar_entities=[VDBSearchResultItem(node_id='aaa4174b5562398d26a02a0f4cd349d6', entity_name='french revolution', score=0.7837987542152405), VDBSearchResultItem(node_id='ebce4c8326aba365917efc283369f183', entity_name='financial crisis', score=0.8011731505393982)]
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:111 - Orchestrator: Stored output 'vdb_search_output' for step step1_vdb_for_one_hop (tool Entity.VDBSearch) as Pydantic model or its primary attribute.
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:42 - Orchestrator: Executing Step 2/2: step2_one_hop_neighbors - Find one-hop neighbors for entities found by VDB search.
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:47 - Orchestrator: Step step2_one_hop_neighbors is a DynamicToolChainConfig with 1 tool(s).
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:64 - Orchestrator: Executing tool 1/1 in step step2_one_hop_neighbors: Relationship.OneHopNeighbors
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:_resolve_tool_inputs:177 - Orchestrator: Transformed 'similar_entities' from step 'step1_vdb_for_one_hop' into List[str] of entity names for input 'entity_ids'. Extracted 2 IDs.
2025-05-31 11:55:56.388 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:87 - Orchestrator: Attempting to instantiate RelationshipOneHopNeighborsInputs with params: {'entity_ids': ['french revolution', 'financial crisis']}
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:89 - Orchestrator: Successfully instantiated RelationshipOneHopNeighborsInputs for tool Relationship.OneHopNeighbors
2025-05-31 11:55:56.388 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:92 - Orchestrator: Calling tool function: relationship_one_hop_neighbors_tool for tool ID: Relationship.OneHopNeighbors
2025-05-31 11:55:56.389 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:94 - Orchestrator: Tool Relationship.OneHopNeighbors executed. Output type: <class 'Core.AgentSchema.tool_contracts.RelationshipOneHopNeighborsOutputs'>
2025-05-31 11:55:56.389 | DEBUG    | Core.AgentOrchestrator.orchestrator:execute_plan:95 - Orchestrator: Raw output from tool Relationship.OneHopNeighbors: one_hop_relationships=[RelationshipData(src_id='french revolution', tgt_id='estates general', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the french revolution began with the estates general of 1789  a pivotal event that set the revolution in motion', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general', 'tgt_id': 'french revolution'}), RelationshipData(src_id='french revolution', tgt_id='coup of 18 brumaire', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=7.0, description='the french revolution ended with the coup of 18 brumaire in 1799  marking a significant political transition', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'coup of 18 brumaire', 'tgt_id': 'french revolution'}), RelationshipData(src_id='financial crisis', tgt_id='estates general of 1789', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the financial crisis in france directly led to the convocation of the estates general in 1789  setting the stage for revolutionary actions', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general of 1789', 'tgt_id': 'financial crisis'})]
2025-05-31 11:55:56.389 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:111 - Orchestrator: Stored output 'one_hop_neighbor_details' for step step2_one_hop_neighbors (tool Relationship.OneHopNeighbors) as Pydantic model or its primary attribute.
2025-05-31 11:55:56.389 | INFO     | Core.AgentOrchestrator.orchestrator:execute_plan:131 - Orchestrator: Plan execution finished. Final result from step 'step2_one_hop_neighbors': {'one_hop_neighbor_details': RelationshipOneHopNeighborsOutputs(one_hop_relationships=[RelationshipData(src_id='french revolution', tgt_id='estates general', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the french revolution began with the estates general of 1789  a pivotal event that set the revolution in motion', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general', 'tgt_id': 'french revolution'}), RelationshipData(src_id='french revolution', tgt_id='coup of 18 brumaire', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=7.0, description='the french revolution ended with the coup of 18 brumaire in 1799  marking a significant political transition', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'coup of 18 brumaire', 'tgt_id': 'french revolution'}), RelationshipData(src_id='financial crisis', tgt_id='estates general of 1789', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the financial crisis in france directly led to the convocation of the estates general in 1789  setting the stage for revolutionary actions', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general of 1789', 'tgt_id': 'financial crisis'})])}
2025-05-31 11:55:56.389 | INFO     | __main__:run_vdb_to_one_hop_neighbors_plan:326 - Orchestrator Test: VDB -> OneHopNeighbors Plan execution finished. Final output from orchestrator (last step's output): {'one_hop_neighbor_details': RelationshipOneHopNeighborsOutputs(one_hop_relationships=[RelationshipData(src_id='french revolution', tgt_id='estates general', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the french revolution began with the estates general of 1789  a pivotal event that set the revolution in motion', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general', 'tgt_id': 'french revolution'}), RelationshipData(src_id='french revolution', tgt_id='coup of 18 brumaire', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=7.0, description='the french revolution ended with the coup of 18 brumaire in 1799  marking a significant political transition', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'coup of 18 brumaire', 'tgt_id': 'french revolution'}), RelationshipData(src_id='financial crisis', tgt_id='estates general of 1789', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the financial crisis in france directly led to the convocation of the estates general in 1789  setting the stage for revolutionary actions', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general of 1789', 'tgt_id': 'financial crisis'})])}
2025-05-31 11:55:56.389 | INFO     | __main__:run_vdb_to_one_hop_neighbors_plan:327 - Orchestrator Test: All step outputs for VDB -> OneHopNeighbors plan: {'step1_vdb_for_one_hop': {'vdb_search_output': EntityVDBSearchOutputs(similar_entities=[VDBSearchResultItem(node_id='aaa4174b5562398d26a02a0f4cd349d6', entity_name='french revolution', score=0.7837987542152405), VDBSearchResultItem(node_id='ebce4c8326aba365917efc283369f183', entity_name='financial crisis', score=0.8011731505393982)])}, 'step2_one_hop_neighbors': {'one_hop_neighbor_details': RelationshipOneHopNeighborsOutputs(one_hop_relationships=[RelationshipData(src_id='french revolution', tgt_id='estates general', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the french revolution began with the estates general of 1789  a pivotal event that set the revolution in motion', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general', 'tgt_id': 'french revolution'}), RelationshipData(src_id='french revolution', tgt_id='coup of 18 brumaire', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=7.0, description='the french revolution ended with the coup of 18 brumaire in 1799  marking a significant political transition', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'coup of 18 brumaire', 'tgt_id': 'french revolution'}), RelationshipData(src_id='financial crisis', tgt_id='estates general of 1789', source_id='graph_traversal_tool', relation_name='unknown_relationship', weight=8.0, description='the financial crisis in france directly led to the convocation of the estates general in 1789  setting the stage for revolutionary actions', keywords='', rank=0, attributes={'source_id': 'chunk-368c7113ca6d5c34ca1cc15cf9e2825a', 'relation_name': 'relationship', 'keywords': '', 'src_id': 'estates general of 1789', 'tgt_id': 'financial crisis'})])}}
2025-05-31 11:55:56.390 | INFO     | __main__:main_orchestrator_test:263 - --- Test Plan 3 Finished ---
2025-05-31 11:55:56.390 | INFO     | __main__:main_orchestrator_test:265 - --- Agent Orchestrator Test Finished ---
INFO [Config.default]: Loaded default config from Option/Config2.yaml
WARNING [Config.default]: Graph config not found in default YAMLs/data, creating default GraphConfig.
WARNING [Config.default]: Chunk config not found in default YAMLs/data, creating default ChunkConfig.
WARNING [Config.default]: Retriever config not found or invalid in default YAMLs/data, creating default RetrieverConfig.
WARNING [Config.default]: Query config (query_config) not found or invalid in default YAMLs/data, creating default QueryConfig.
INFO [Config.default]: Successfully created default Config instance.
